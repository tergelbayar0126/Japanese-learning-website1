/**\n * Utilities Module - Helper functions for the Japanese Learning Platform\n * Provides common utility functions used across modules\n */\n\nconst Utils = {\n    /**\n     * Safely get nested object property\n     * @param {object} obj - Object to get property from\n     * @param {string} path - Path to property (e.g., 'a.b.c')\n     * @param {*} defaultValue - Default if not found\n     */\n    getNestedProperty(obj, path, defaultValue = null) {\n        try {\n            return path.split('.').reduce((acc, part) => acc?.[part], obj) ?? defaultValue;\n        } catch (e) {\n            return defaultValue;\n        }\n    },\n    \n    /**\n     * Throttle function execution\n     * @param {function} func - Function to throttle\n     * @param {number} delay - Minimum delay between calls\n     */\n    throttle(func, delay) {\n        let lastCall = 0;\n        return function (...args) {\n            const now = Date.now();\n            if (now - lastCall >= delay) {\n                lastCall = now;\n                return func.apply(this, args);\n            }\n        };\n    },\n    \n    /**\n     * Debounce function execution\n     * @param {function} func - Function to debounce\n     * @param {number} delay - Delay before execution\n     */\n    debounce(func, delay) {\n        let timeoutId;\n        return function (...args) {\n            clearTimeout(timeoutId);\n            timeoutId = setTimeout(() => func.apply(this, args), delay);\n        };\n    },\n    \n    /**\n     * Check if character is hiragana\n     * @param {string} char - Character to check\n     */\n    isHiragana(char) {\n        return /^[\\u3040-\\u309F]$/.test(char);\n    },\n    \n    /**\n     * Check if character is katakana\n     * @param {string} char - Character to check\n     */\n    isKatakana(char) {\n        return /^[\\u30A0-\\u30FF]$/.test(char);\n    },\n    \n    /**\n     * Check if character is kanji\n     * @param {string} char - Character to check\n     */\n    isKanji(char) {\n        return /^[\\u4E00-\\u9FFF]$/.test(char);\n    },\n    \n    /**\n     * Safely play sound with error handling\n     * @param {object} soundObj - Sound object with play method\n     * @param {string} fallbackName - Name for logging\n     */\n    playSound(soundObj, fallbackName = 'sound') {\n        try {\n            if (soundObj && typeof soundObj.play === 'function') {\n                soundObj.play().catch(() => {});\n            }\n        } catch (e) {\n            if (typeof DEBUG !== 'undefined' && DEBUG) {\n                console.warn(`Could not play ${fallbackName}:`, e.message);\n            }\n        }\n    },\n    \n    /**\n     * Format number with comma separators\n     * @param {number} num - Number to format\n     */\n    formatNumber(num) {\n        return num.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, ',');\n    },\n    \n    /**\n     * Clamp value between min and max\n     * @param {number} value - Value to clamp\n     * @param {number} min - Minimum value\n     * @param {number} max - Maximum value\n     */\n    clamp(value, min, max) {\n        return Math.max(min, Math.min(max, value));\n    },\n    \n    /**\n     * Create delay promise\n     * @param {number} ms - Milliseconds to delay\n     */\n    delay(ms) {\n        return new Promise(resolve => setTimeout(resolve, ms));\n    },\n    \n    /**\n     * Shuffle array in place\n     * @param {array} array - Array to shuffle\n     */\n    shuffle(array) {\n        for (let i = array.length - 1; i > 0; i--) {\n            const j = Math.floor(Math.random() * (i + 1));\n            [array[i], array[j]] = [array[j], array[i]];\n        }\n        return array;\n    },\n    \n    /**\n     * Get random element from array\n     * @param {array} array - Array to pick from\n     */\n    randomElement(array) {\n        return array[Math.floor(Math.random() * array.length)];\n    },\n    \n    /**\n     * Create a unique ID\n     */\n    generateId() {\n        return '_' + Math.random().toString(36).substr(2, 9);\n    },\n    \n    /**\n     * Safe JSON parse\n     * @param {string} jsonString - String to parse\n     * @param {*} defaultValue - Default if parsing fails\n     */\n    parseJSON(jsonString, defaultValue = null) {\n        try {\n            return JSON.parse(jsonString);\n        } catch (e) {\n            return defaultValue;\n        }\n    }\n};\n\n// Expose globally\nwindow.Utils = Utils;\n